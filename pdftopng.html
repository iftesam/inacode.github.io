<html>
  <head>
    <title>PDF to PNG Converter</title>
    <style>
      body {
        font-family: "Roboto", sans-serif;
        background-color: #f5f5f5;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
      }

      h1 {
        text-align: center;
        margin: 40px 0;
        font-size: 36px;
        font-weight: 300;
        color: #4caf50;
      }

      p {
        margin: 20px 0;
        font-size: 18px;
      }

      form {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      #pdfFileInput {
        display: block;
        margin: 0 auto;
        padding: 10px;
        border: 2px dashed #ccc;
        border-radius: 5px;
        font-size: 16px;
        width: 300px;
        box-sizing: border-box;
        transition: border-color 0.2s;
        appearance: none;
        -webkit-appearance: none;
      }

      #pdfFileInput:focus {
        border-color: #4caf50;
        outline: none;
      }

      #pdfFileInput::-webkit-file-upload-button {
        appearance: none;
        -webkit-appearance: none;
        font-size: 16px;
        border: 2px solid #4caf50;
        border-radius: 5px;
        background-color: #4caf50;
        color: #fff;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      #pdfFileInput::-moz-file-upload-button {
        appearance: none;
        font-size: 16px;
        border: 2px solid #4caf50;
        border-radius: 5px;
        background-color: #4caf50;
        color: #fff;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      #pdfFileInput:hover::-webkit-file-upload-button,
      #pdfFileInput:hover::-moz-file-upload-button {
        background-color: #3d8b40;
      }

      #convertButton {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #4caf50;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      #convertButton:hover {
        background-color: #3d8b40;
      }

      #convertButton:active {
        background-color: #2e7032;
        transform: translateY(2px);
      }
    </style>
    <!-- <style>
      body {
        font-family: "Roboto", sans-serif;
        background-color: #f5f5f5;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
      }

      h1 {
        text-align: center;
        margin: 40px 0;
        font-size: 36px;
        font-weight: 300;
        color: #4caf50;
      }

      p {
        margin: 20px 0;
        font-size: 18px;
      }

      form {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      #pdfFileInput {
        display: block;
        margin: 0 auto;
        padding: 10px;
        border: 2px dashed #ccc;
        border-radius: 5px;
        font-size: 16px;
        width: 300px;
        box-sizing: border-box;
        transition: border-color 0.2s;
        appearance: none;
        -webkit-appearance: none;
      }

      #pdfFileInput:focus {
        border-color: #4caf50;
        outline: none;
      }

      #pdfFileInput::-webkit-file-upload-button {
        appearance: none;
        -webkit-appearance: none;
        font-size: 16px;
        border: 2px solid #4caf50;
        border-radius: 5px;
        background-color: #4caf50;
        color: #fff;
        cursor: pointer;
      }

      #pdfFileInput::-moz-file-upload-button {
        appearance: none;
        font-size: 16px;
        border: 2px solid #4caf50;
        border-radius: 5px;
        background-color: #4caf50;
        color: #fff;
        cursor: pointer;
      }

      #convertButton {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #4caf50;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      #convertButton:hover {
        background-color: #3d8b40;
      }

      #convertButton:active {
        transform: translateY(2px);
      }

      #statusMessage {
        text-align: center;
        margin: 20px 0;
        font-size: 18px;
      }

      #statusMessage.error {
        color: #f44336;
      }
    </style> -->
    <!-- <style>
        body {
        font-family: 'Roboto', sans-serif;
        background-color: #f5f5f5;
        color: #333;
        }

        h1 {
        text-align: center;
        margin: 40px 0;
        font-size: 36px;
        font-weight: 300;
        }

        p {
        margin: 20px 0;
        font-size: 18px;
        }

        #pdfFileInput {
        display: block;
        margin: 0 auto;
        padding: 10px;
        border: 2px dashed #ccc;
        border-radius: 5px;
        font-size: 16px;
        width: 300px;
        box-sizing: border-box;
        transition: border-color 0.2s;
        }

        #pdfFileInput:focus {
        border-color: #4caf50;
        outline: none;
        }

        #convertButton {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #4caf50;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.2s;
        }

        #convertButton:hover {
        background-color: #3d8b40;
        }

        #convertButton:active {
        transform: translateY(2px);
        }

        #statusMessage {
        text-align: center;
        margin: 20px 0;
        font-size: 18px;
        }

        #statusMessage.error {
        color: #f44336;
        }
    </style> -->
    <!-- <style>
        body {
        font-family: Arial, sans-serif;
        }

        h1 {
        text-align: center;
        margin: 20px 0;
        }

        p {
        margin: 10px 0;
        }

        #pdfFileInput {
        display: block;
        margin: 0 auto;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
        width: 300px;
        }

        #convertButton {
        display: block;
        margin: 20px auto;
        padding: 10px;
        background-color: #4caf50;
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        }

        #statusMessage {
        text-align: center;
        margin: 20px 0;
        font-size: 18px;
        }
    </style> -->
  </head>
  <body>
    <h1>PDF to PNG Converter</h1>
    <p>Select a PDF to convert to a PNG:</p>
    <input type="file" id="pdfFileInput" accept=".pdf" />
    <button id="convertButton">Convert to PNG</button>
    <p id="statusMessage"></p>

    <script>
      $(document).ready(function () {
        // Handle the convert button click
        $("#convertButton").click(function () {
          // Get the selected PDF file
          var pdfFile = $("#pdfFileInput")[0].files[0];
          if (!pdfFile) {
            updateStatusMessage("Please select a PDF to convert.", "error");
            return;
          }

          // Update the status message
          updateStatusMessage("Converting PDF to PNG...");

          // Send a POST request to the CloudConvert API to start the conversion process
          fetch("https://api.cloudconvert.com/v2/convert", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: "Bearer YOUR_API_KEY",
            },
            body: JSON.stringify({
              input: "upload",
              inputformat: "pdf",
              outputformat: "png",
              file: pdfFile,
            }),
          })
            .then(function (response) {
              // Check the response status
              if (response.ok) {
                // Get the conversion process ID from the response
                return response.json().then(function (data) {
                  return data.id;
                });
              } else {
                throw new Error(
                  "Error starting conversion process: " + response.statusText
                );
              }
            })
            .then(function (processId) {
              // Poll the CloudConvert API until the conversion process is finished
              return new Promise(function (resolve, reject) {
                function poll() {
                  // Send a GET request to the CloudConvert API to get the status of the conversion process
                  fetch(
                    "https://api.cloudconvert.com/v2/convert/" + processId,
                    {
                      headers: {
                        "Content-Type": "application/json",
                        Authorization: "Bearer YOUR_API_KEY",
                      },
                    }
                  )
                    .then(function (response) {
                      // Check the response status
                      if (response.ok) {
                        // Get the conversion process status from the response
                        return response.json().then(function (data) {
                          return data.step;
                        });
                      } else {
                        throw new Error(
                          "Error getting conversion status: " +
                            response.statusText
                        );
                      }
                    })
                    .then(function (status) {
                      // Check the conversion process status
                      if (status === "finished") {
                        // Resolve the promise to indicate that the conversion is finished
                        resolve();
                      } else if (status === "error") {
                        // Reject the promise with an error message
                        reject(new Error("Conversion failed"));
                      } else {
                        // Wait 1 second and poll again
                        setTimeout(poll, 1000);
                      }
                    })
                    .catch(function (error) {
                      // Reject the promise with the error
                      reject(error);
                    });
                }

                // Start polling
                poll();
              });
            })
            .then(function () {
              // Update the status message
              updateStatusMessage(
                "Conversion finished, downloading ZIP file..."
              );

              // Send a GET request to the CloudConvert API to download the ZIP file
              fetch("https://api.cloudconvert.com/v2/download/" + processId, {
                headers: {
                  Authorization: "Bearer YOUR_API_KEY",
                },
              })
                .then(function (response) {
                  // Check the response status
                  if (response.ok) {
                    // Create a Blob from the response
                    return response.blob();
                  } else {
                    throw new Error(
                      "Error downloading ZIP file: " + response.statusText
                    );
                  }
                })
                .then(function (zipBlob) {
                  // Create an anchor element to simulate a download
                  var a = document.createElement("a");
                  a.href = URL.createObjectURL(zipBlob);
                  a.download = "converted.zip";
                  a.style.display = "none";
                  document.body.appendChild(a);

                  // Click the anchor element to initiate the download
                  a.click();

                  // Remove the anchor element
                  document.body.removeChild(a);
                })
                .catch(function (error) {
                  // Update the status message
                  updateStatusMessage(error.message, "error");
                });
            })
            .catch(function (error) {
              // Update the status message
              updateStatusMessage(error.message, "error");
            });
        });
      });

      // Update the status message
      function updateStatusMessage(message, type) {
        // Set the status message text and color
        $("#statusMessage").text(message);
        if (type === "error") {
          $("#statusMessage").css("color", "red");
        } else {
          $("#statusMessage").css("color", "black");
        }
      }
    </script>
  </body>
</html>
